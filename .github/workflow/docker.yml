# **NOTE**: this file is generated by `dhall-render`.
# You should NOT edit it manually, your changes will be lost.

---
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
      with:
        fetch-depth: '1'
    - name: Docker build
      run: |-
        set -eu -o pipefail
        set -x
        env DOCKER_BUILDKIT=1 docker "build" "--progress=plain" "--file=Dockerfile" "--build-arg=DHALL_VERSION=1.33.0" "--build-arg=DHALL_JSON_VERSION=1.7.0" "--build-arg=DHALL_YAML_VERSION=1.2.0" "--build-arg=BUILDKIT_INLINE_CACHE=1" "--cache-from=docker.pkg.github.com/timbertson/dhall-ci:latest" "--cache-from=docker.pkg.github.com/timbertson/dhall-ci:$(echo "$(if [[ -n ${GITHUB_HEAD_REF:-} ]]; then echo "$GITHUB_HEAD_REF"; else echo "${GITHUB_REF##refs/heads/}"; fi)" | tr / -)" "--tag=docker.pkg.github.com/timbertson/dhall-ci:$GITHUB_SHA" "--tag=docker.pkg.github.com/timbertson/dhall-ci:$(echo "$(if [[ -n ${GITHUB_HEAD_REF:-} ]]; then echo "$GITHUB_HEAD_REF"; else echo "${GITHUB_REF##refs/heads/}"; fi)" | tr / -)" "."
        docker push "docker.pkg.github.com/timbertson/dhall-ci:$GITHUB_SHA"
        docker push "docker.pkg.github.com/timbertson/dhall-ci:$(echo "$(if [[ -n ${GITHUB_HEAD_REF:-} ]]; then echo "$GITHUB_HEAD_REF"; else echo "${GITHUB_REF##refs/heads/}"; fi)" | tr / -)"
    - if: github.event_name == 'push' && (github.ref == 'refs/heads/master' || github.ref
        == 'refs/heads/master')
      name: Docker push :latest
      run: |-
        set -eu -o pipefail
        set -x
        docker tag "docker.pkg.github.com/timbertson/dhall-ci:$GITHUB_SHA" "docker.pkg.github.com/timbertson/dhall-ci:latest"
        docker push "docker.pkg.github.com/timbertson/dhall-ci:latest"
name: CI
'on':
  pull_request: {}
  push:
    branches:
    - master
    - main
